@use '@angular/material' as mat;

/* ============================================
   Material Component Overrides
   Customize Material components to match Tremor's minimal aesthetic
   ============================================ */

// ===== Cards - Tremor Style (minimal elevation, subtle borders) =====
@include mat.card-overrides(
  (
    // Outlined card styling (with border)
    elevated-container-color: var(--tremor-background-default),
    elevated-container-shape: var(--tremor-radius-md),
    elevated-container-elevation: var(--tremor-shadow-sm),
    outlined-container-color: var(--tremor-background-default),
    outlined-container-shape: var(--tremor-radius-md),
    outlined-outline-color: var(--tremor-border-default),
    outlined-outline-width: 1px,
    outlined-container-elevation: var(--tremor-shadow-sm)
  )
);

// Card header border (no token available, keep direct CSS)
.mat-mdc-card-header {
  border-bottom: 1px solid var(--tremor-border-default);
}

// ===== Buttons - Tremor Style (flatter, cleaner) =====
// FAB buttons
@include mat.fab-overrides(
  (
    // Shape
    container-shape: var(--tremor-radius-md),
    small-container-shape: var(--tremor-radius-md),
    // Shadows
    container-elevation-shadow: var(--tremor-shadow-md),
    hover-container-elevation-shadow: var(--tremor-shadow-lg),
    small-container-elevation-shadow: var(--tremor-shadow-md),
    small-hover-container-elevation-shadow: var(--tremor-shadow-lg)
  )
);

// Icon buttons
@include mat.icon-button-overrides(
  (
    // Shape
    container-shape: var(--tremor-radius-md)
  )
);

// Regular buttons (raised, outlined, text, etc.)
@include mat.button-overrides(
  (
    // Protected (raised/elevated) buttons
    protected-container-shape: var(--tremor-radius-md),
    protected-container-elevation-shadow: var(--tremor-shadow-sm),
    protected-hover-container-elevation-shadow: var(--tremor-shadow-md),
    protected-pressed-container-elevation-shadow: var(--tremor-shadow-sm),
    // Outlined buttons
    outlined-container-shape: var(--tremor-radius-md),
    outlined-outline-color: var(--tremor-border-default),
    // Text buttons
    text-container-shape: var(--tremor-radius-md),
    // Filled buttons
    filled-container-shape: var(--tremor-radius-md),
    // Tonal buttons
    tonal-container-shape: var(--tremor-radius-md)
  )
);

// ===== Form Fields - Tremor Style (clean borders) =====
.mat-mdc-form-field {
  // Outlined style
  .mat-mdc-text-field-wrapper {
    .mat-mdc-form-field-flex {
      .mdc-notched-outline {
        .mdc-notched-outline__leading,
        .mdc-notched-outline__notch,
        .mdc-notched-outline__trailing {
          border-color: var(--tremor-border-default) !important;
        }
      }
    }
  }

  // Focus state
  &.mat-focused {
    .mdc-notched-outline {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--tremor-brand-default) !important;
        border-width: 2px !important;
      }
    }
  }

  // Error state
  &.mat-form-field-invalid {
    .mdc-notched-outline {
      .mdc-notched-outline__leading,
      .mdc-notched-outline__notch,
      .mdc-notched-outline__trailing {
        border-color: var(--md-sys-color-error) !important;
      }
    }
  }
}

// Fix faint left border on form field notch
.mat-mdc-form-field .mdc-notched-outline__notch {
  border-left: none !important;
}

// Input elements
.mat-mdc-input-element {
  color: var(--tremor-content-strong) !important;

  &::placeholder {
    color: var(--tremor-content-subtle) !important;
  }
}

// ===== Tables - Clean borders like Tremor =====
.mat-mdc-table {
  background: var(--tremor-background-default);
  border: 1px solid var(--tremor-border-default);
  border-radius: var(--tremor-radius-md);
  overflow: hidden;

  .mat-mdc-header-row {
    background: var(--tremor-background-subtle);
    border-bottom: 1px solid var(--tremor-border-default);
  }

  .mat-mdc-row {
    border-bottom: 1px solid var(--tremor-border-default);

    &:last-child {
      border-bottom: none;
    }

    &:hover {
      background: var(--tremor-background-muted);
    }
  }

  .mat-mdc-cell,
  .mat-mdc-header-cell {
    border-right: 1px solid var(--tremor-border-default);

    &:last-child {
      border-right: none;
    }
  }
}

// ===== Chips - Tremor Style =====
// Using Angular Material chips-overrides mixin (official M3 approach)
@include mat.chips-overrides(
  (
    // Outline (border) styling
    outline-color: var(--tremor-border-default),
    outline-width: 1px,

    // Container colors
    elevated-container-color: var(--tremor-background-subtle),
    elevated-selected-container-color: var(--tremor-brand-faint),
    elevated-disabled-container-color: var(--tremor-background-subtle),
    // Label text colors
    label-text-color: var(--tremor-content-strong),
    selected-label-text-color: var(--tremor-brand-emphasis),
    disabled-label-text-color: var(--tremor-content-subtle),
    // Disabled outline
    disabled-outline-color: var(--tremor-border-default),
    // Shape (border radius)
    container-shape-radius: var(--tremor-radius-md),
    // Selected outline width
    flat-selected-outline-width: 1px
  )
);

// ===== Dialogs - Tremor Style =====
.mat-mdc-dialog-container {
  .mdc-dialog__surface {
    border-radius: var(--tremor-radius-lg) !important;
    border: 1px solid var(--tremor-border-default) !important;
    box-shadow: var(--tremor-shadow-lg) !important;
    background: var(--tremor-background-default) !important;
  }
}

// ===== Menus - Tremor Style =====
.mat-mdc-menu-panel {
  border: 1px solid var(--tremor-border-default) !important;
  border-radius: var(--tremor-radius-md) !important;
  box-shadow: var(--tremor-shadow-md) !important;
  background: var(--tremor-background-default) !important;
}

.mat-mdc-menu-item {
  &:hover:not([disabled]) {
    background: var(--tremor-background-subtle) !important;
  }
}

// ===== Tabs - Tremor Style =====
.mat-mdc-tab-group {
  .mat-mdc-tab-header {
    border-bottom: 1px solid var(--tremor-border-default);
  }

  .mat-mdc-tab {
    &:hover:not(.mat-mdc-tab-disabled) {
      background: var(--tremor-background-subtle);
    }
  }

  .mat-mdc-tab-body-content {
    padding: var(--tremor-spacing-lg);
  }
}

// ===== Expansion Panels - Tremor Style =====
.mat-expansion-panel {
  border: 1px solid var(--tremor-border-default) !important;
  border-radius: var(--tremor-radius-md) !important;
  box-shadow: none !important;
  background: var(--tremor-background-default) !important;

  & + .mat-expansion-panel {
    margin-top: var(--tremor-spacing-sm);
  }

  &:not(.mat-expanded) {
    .mat-expansion-panel-header:hover {
      background: var(--tremor-background-subtle) !important;
    }
  }
}

// ===== Progress Bars - Minimal =====
.mat-mdc-progress-bar {
  border-radius: var(--tremor-radius-sm);
  overflow: hidden;
}

// ===== Sliders - Clean style =====
.mat-mdc-slider {
  .mdc-slider__track {
    border-radius: var(--tremor-radius-sm);
  }
}

// ===== Toolbar - Tremor Style =====
.mat-toolbar {
  border-bottom: 1px solid var(--tremor-border-default);
  box-shadow: var(--tremor-shadow-sm);
}

// ===== Lists - Clean borders =====
.mat-mdc-list {
  .mat-mdc-list-item {
    border-bottom: 1px solid var(--tremor-border-default);

    &:last-child {
      border-bottom: none;
    }

    &:hover:not([disabled]) {
      background: var(--tremor-background-subtle);
    }
  }
}

// ===== Badges - Tremor Style =====
.mat-badge-content {
  border-radius: var(--tremor-radius-sm);
  box-shadow: var(--tremor-shadow-sm);
}

// ===== Tooltips - Minimal =====
.mat-mdc-tooltip {
  border-radius: var(--tremor-radius-sm);
  box-shadow: var(--tremor-shadow-md);
}

// ===== Snackbars - Tremor Style =====
.mat-mdc-snack-bar-container {
  border-radius: var(--tremor-radius-md) !important;
  border: 1px solid var(--tremor-border-default) !important;
  box-shadow: var(--tremor-shadow-lg) !important;
}
